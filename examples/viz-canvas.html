<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
    <!-- canvas for visualization -->
    <canvas id="waax-canvas" width="300" height="800"></canvas>
    
    <!-- development setting (uncompiled) -->
    <script src="../core/WAAX.js"></script>
    <script src="../core/Util.js"></script>
    <script src="../core/Internals.js"></script>
    <script src="../core/Fader.js"></script>
    <script src="../core/Oscil.js"></script>
    <script src="../core/Noise.js"></script>
    <script src="../core/Sampler.js"></script>
    <script src="../core/LFO.js"></script>    
    <script src="../core/LPF.js"></script>      
    <script src="../core/ConVerb.js"></script>
    <script src="../core/FeedbackDelay.js"></script>
    <script src="../core/Comp.js"></script>
    <script src="../core/C2.js"></script>
    <script src="../core/WaveformV.js"></script>
    <script>
      // waax audio code
      var osc = new WX.Oscil(), 
      mod = new WX.Oscil(),
        vb = new WX.VBridge();
        mod.to(osc).to(vb).to(WX.Out);
    mod.gain = 500.0;
    mod.frequency = 200.0;
      
      // canvas context
      var cvs = document.getElementById('waax-canvas');
      cvs.style.position = 'absolute';
      cvs.style.right = '100px';
      var ctx = cvs.getContext('2d');
      ctx.lineWidth = 1;
      ctx.strokeStyle = 'black';
      
      // user-defined render function
      vb.onRender = function(buffer) {
        // clear
        ctx.clearRect(0, 0, cvs.width, cvs.height);
        // draw waveform
        ctx.beginPath();
        for(var i = 0, b = buffer.length; i < b; ++i) {
          ctx.lineTo(150 - buffer[i] * 150, i*0.5);
        }
        ctx.stroke();
      }
      
      // looper
      function run() {
        setTimeout(function() {
          vb.render();
          run();
        }, 1000/30);
      }
      
      // start!
      run();
    </script>
  </body>
</html>