<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
    <h1>Samplr!</h1>
    <ul>
      <li><b>Z</b> - Kick Drum</li>
      <li><b>Right Shift</b> - Snare Drum</li>
      <li><b>Slash (/)</b> - Hihat</li>
    </ul>
    <canvas id="canvas-wx-waveform" width="675px" height="360px"></canvas>
    <script src="http://ajax.googleapis.com/ajax/libs/jquery/1.9.1/jquery.min.js"></script>
    <script src="http://hoch.github.com/waax/build/WAAX.min.js"></script>
    <script>
      // paths
      var PATH_SAMPLES = "../data/drums/",
          PATH_IR = "../data/ir/";

      // a simple drum sampler with compressor, reverb, and delay
      var kd1 = new WX.Sampler({ source:PATH_SAMPLES + "kick-1.wav" }),
          kd2 = new WX.Sampler({ source:PATH_SAMPLES + "kick-2.wav" }),
          sd = new WX.Sampler({ source:PATH_SAMPLES + "snare-1.wav" }),
          hh = new WX.Sampler({ source:PATH_SAMPLES + "hihat-2.wav" }),
          comp = new WX.Comp({ threshold:-9.0, ratio:8.0, gain:4.0 }),
          verb = new WX.ConVerb({ source:PATH_IR + "hall.wav", mix:0.01 });
      var wf = new WX.Waveform({ style:{ width:2 } });

      // connections
      kd1.to(verb).to(comp).to(WX.DAC);
      kd2.to(verb);
      sd.to(verb);
      hh.to(verb);
      comp.to(wf);
      
      // summing 2 KDs for solid bottom
      kd1.gain = 0.5;
      kd2.gain = 0.5;
      
      // key input handling
      $(window).keydown(function(event) {
        event.preventDefault();
        switch(event.which) {
          // noteOn with pitches (60 is default base pitch)
          case 90:  kd1.noteOn(55); kd2.noteOn(60); break;
          case 16:  sd.noteOn(67);  break;
          case 191: hh.noteOn(67);  break;
        }
      });
      
      // draw visualization
      function draw() {
        requestAnimationFrame(draw);
        wf.draw();
      }
      requestAnimationFrame(draw);
    </script>
  </body>
</html>