<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
    <h1>WAAX does THX!!</h1>
    <canvas id="canvas-wx-spectrum" width="650px" height="255px"></canvas>
    <script src="http://hoch.github.com/waax/build/WAAX.min.js"></script>
    <script>
      /**
       * THX emulator on WAAX
       * by Perry R. Cook and Ge Wang for ChucK
       * WAAX version ported by Hongchan Choi
       */
      // F-1, B1b,  F1,    B2b,   F2,    B3b,   F3,    A5,    F4,   A6
      var targets = [ 
        29.0, 87.5, 116.0, 175.0, 233.0, 350.0, 524.0, 880.0, 1048, 1760,
        29.0, 87.5, 116.0, 175.0, 233.0, 350.0, 524.0, 880.0, 1048, 1760,
        29.0, 87.5, 116.0, 175.0, 233.0, 350.0, 524.0, 880.0, 1048, 1760 
      ];
      var initials = [];
      
      var verb = new WX.ConVerb({ mix:0.025 });
      var comp = new WX.Comp({ gain:2 });
      var sp = new WX.Spectrum({ style:{ color:"#f66" } });
      var saws = [];
      for(var i = 0; i < 30; ++i) {
        initials[i] = WX.random2f(200.0, 800.0);
        saws[i] = new WX.Oscil({ type:1, frequency:initials[i], gain:0.1 });
        saws[i].to(verb);
      }
      verb.to(comp).to(WX.DAC);
      comp.to(sp);
      WX.DAC.db = -24;
      
      function animate() {
        requestAnimationFrame(animate);
        sp.draw();
      }
      animate();
      
      for(var i = 0; i < 30; ++i) {
        saws[i].glide(targets[i], 4.0);
      }
    </script>
  </body>
</html>