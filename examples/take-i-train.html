<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
    <h1>Take the I train!</h1>
    <canvas id="wx-waveform" width="600" height="300"></canvas>
    <script src="http://hoch.github.com/waax/build/WAAX.min.js"></script>
    <script>
      // audio graph: impulse train followed by LPF with resonance
      var imp = new WX.ImpTrain({ frequency:7 });
      var lpf = new WX.ModLPF({ cutoff:120, Q:20, a:2.0, d:1.0, s:0.5, r:2.0 });
      imp.to(lpf).to(WX.DAC);
      WX.DAC.db = -12;

      // visualization fetching from lpf
      var canvas = document.getElementById("wx-waveform");
      var context2D = canvas.getContext('2d');
      var waveform = new WX.Waveform({ context:context2D });
      lpf.to(waveform);

      // sweeper
      function sweep(next, i) {
        lpf.cutoff = WX.random2f(50, 5000);
        lpf.Q = WX.random2f(15, 25);
        lpf.noteOn(next);
        lpf.noteOff(next + 2.0);
      }

      // looping
      var l = new WX.Loop(sweep, 0, 5.0);
      l.start();

      // drawer
      (function draw() {
        requestAnimationFrame(draw);
        waveform.draw();
      })();
    </script>
  </body>
</html>