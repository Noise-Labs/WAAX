<!DOCTYPE html>
<html>
  <head>
    <link href="static/demos.css" rel="stylesheet" type="text/css">
    <link href="../lib/UI/UI-light.css" rel="stylesheet" type="text/css">
  </head>
  <body>
    
    <h1>Dreamy Impulse</h1>
    <div class="c-body-wrapper" id="i-container">
    </div>

    <!-- lib r8 -->   
    <script src="../src/core/WAAX.js"></script>
    <script src="../src/core/Utils.js"></script>
    <script src="../src/core/Builtin.js"></script>
    <script src="../src/core/Unit.js"></script>
    <script src="../src/generator/Oscil.js"></script>
    <script src="../src/generator/Fmop.js"></script>
    <script src="../src/generator/Noise.js"></script>
    <script src="../src/generator/ITrain.js"></script>
    <script src="../src/generator/Sampler.js"></script>
    <script src="../src/generator/Step.js"></script>
    <script src="../src/processor/Fader.js"></script>
    <script src="../src/processor/Spatter.js"></script>
    <script src="../src/processor/ADSR.js"></script>
    <script src="../src/processor/Filter.js"></script>
    <script src="../src/processor/Filterbank.js"></script>
    <script src="../src/processor/Formant.js"></script>
    <script src="../src/processor/FormantV.js"></script>
    <script src="../src/processor/Pingpong.js"></script>
    <script src="../src/processor/Chorus.js"></script>
    <script src="../src/processor/Phasor.js"></script>
    <script src="../src/processor/Comp.js"></script>
    <script src="../src/processor/Converb.js"></script>
    <script src="../src/analyzer/Waveform.js"></script>
    <script src="../src/analyzer/Spectrum.js"></script>
    <script src="../src/core/Boot.js"></script>
    <!-- Ktrl -->
    <script src="../lib/Ktrl/Ktrl.js"></script>
    <script src="../lib/UI/UI.js"></script>
    <script src="../lib/UI/UISlider.js"></script>
    <script src="../lib/UI/UIButton.js"></script>
    <script src="../lib/UI/UIIndexedList.js"></script>
    <!-- scripts -->
    <script>
      // units
      var uLfo = WX.Oscil({ gain:4.0, freq:0.125 });
      var uImp = WX.ITrain({ gain:1.0, freq:6 });
      var uLpf = WX.Filter({ cutoff:2500, Q:12 });
      var uVerb = WX.Converb({ mix: 0.8 });
      var uPong = WX.Pingpong({ 
        delayTimeLeft: 0.600, delayTimeRight: 0.450, 
        feedbackLeft: 0.3, feedbackRight: 0.5, crosstalk: 0.25 
      });

      // connection
      uImp.to(uLpf).to(uVerb).to(uPong).to(WX.DAC);
      uLfo.control(uLpf.cutoff_);

      // dream on
      // function dream() {
      //   var t1 = WX.now + 4, 
      //       t2 = WX.now + 8;
      //   f
      //     .cutoff(125).Q(12)
      //     .cutoff(2500 + Math.random() * 4000, t1, "x").Q(36, t1, "l")
      //     .cutoff(125, t2, "x").Q(12, t2, "l");
      //   setTimeout(dream, 8000);
      // }
      //dream();

      // ui
      var s_preset = UI.ControlCenter.createSection("Preset Manager", "i-container");
      var l_preset = UI.ControlCenter.createControl({
        type: "indexed-list", name: "Preset", value: "", data: ["Not yet..."],
        exclude: true
      }, s_preset);

      var s_lfoFreq = UI.ControlCenter.createControl({
        type: "slider", name: "LFO Rate", value: 0.125, min: 0.1, max: 20.0,
        precision: 2, scale: "log", unit: "Hz"
      }, s_preset);
      var s_lfoGain = UI.ControlCenter.createControl({
        type: "slider", name: "LFO Depth", value: 125.0, min: 125.0, max: 4000.0,
        precision: 2, scale: "linear", unit: ""
      }, s_preset);
      var s_impFreq = UI.ControlCenter.createControl({
        type: "slider", name: "Imp Frequency", value: 5.0, min: 0.1, max: 20.0,
        precision: 2, scale: "log", unit: "Hz"
      }, s_preset);
      var s_filtCutoff = UI.ControlCenter.createControl({
        type: "slider", name: "Cutoff", value: 2500.0, min: 125.0, max: 7000.0,
        precision: 2, scale: "log", unit: "Hz"
      }, s_preset);
      var s_filtQ = UI.ControlCenter.createControl({
        type: "slider", name: "Q", value: 12.0, min: 12.0, max: 36.0,
        precision: 2, scale: "linear", unit: ""
      }, s_preset);
      var s_verbMix = UI.ControlCenter.createControl({
        type: "slider", name: "Reverb Mix", value: 0.8, min: 0.0, max: 1.0,
        precision: 2, scale: "linear", unit: ""
      }, s_preset);
      var s_dlyTime = UI.ControlCenter.createControl({
        type: "slider", name: "Delay Time", value: 0.6, min: 0.001, max: 1.0,
        precision: 2, scale: "linear", unit: ""
      }, s_preset);

      s_lfoFreq.addAction(function (value) {
        uLfo.freq(value, WX.now + 0.02, "x");
      });
      s_lfoGain.addAction(function (value) {
        uLfo.gain(value, WX.now + 0.02, "x");
      });
      s_impFreq.addAction(function (value) {
        uImp.freq(value, WX.now + 0.02, "x");
      });
      s_filtCutoff.addAction(function (value) {
        uLpf.cutoff(value, WX.now + 0.02, "x");
      });
      s_filtQ.addAction(function (value) {
        uLpf.Q(value, WX.now + 0.02, "x");
      });
      s_verbMix.addAction(function (value) {
        uVerb.mix(value, WX.now + 0.02, "x");
      });
      s_dlyTime.addAction(function (value) {
        uPong.delayTimeLeft(value, WX.now + 0.02, "l");
        uPong.delayTimeLeft(value * 0.75, WX.now + 0.02, "l");
      });

    </script>
  </body>
</html>