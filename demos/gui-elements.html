<!DOCTYPE html>
<html>
  <head>
    <link href="static/demos.css" rel="stylesheet" type="text/css">
    <link href="../lib/UI/UI-light.css" rel="stylesheet" type="text/css">
  </head>
  <body>

    <div class="c-demohome"><a href="index.html">Index</a></div>
    <h1>UI Design</h1>

    <div class="c-body-wrapper" id="i-container">

    <!-- scripts -->
    <script src="../lib/Ktrl/Ktrl.js"></script>
    <script src="../lib/UI/UI.js"></script>
    <script src="../lib/UI/UISlider.js"></script>
    <script src="../lib/UI/UIButton.js"></script>
    <script src="../lib/UI/UIIndexedList.js"></script>

    <!-- preset data-->
    <script src="presets/testPresets.js"></script>

    <!-- main code -->
    <script>

      /* examples structure
        1) build synth
        2) build UI components
        3) build relationship (midi => controller => action => synth)
        4) load init parameters
       */

      // get presets from file (should use AJAX for this?)
      UI.ControlCenter.importPresetBundle(myPresetBundle);
      UI.ControlCenter.importRouteMap(myProfile.MIDIRouteMap);

      // preset section
      var presetSection = UI.ControlCenter.createSection("Preset Manager", "i-container");
      var
      list_presets = UI.ControlCenter.createControl({
        type: "indexed-list", name: "Preset", value: "",
        data: UI.ControlCenter.getPresetList(),
        exclude: true
      }, presetSection),
      btn_savePreset = UI.ControlCenter.createControl({
        type: "button", name: "Save", value: false, mode: "oneshot",
        exclude: true
      }, presetSection);

      // master section
      var masterSection = UI.ControlCenter.createSection("Master Control", "i-container");
      var
      masterGain = UI.ControlCenter.createControl({
        type: "slider", name: "Master", value: 0.0, min: -80.0, max: 0.0,
        precision: 2, scale: "linear", unit: "dB"
      }, masterSection),
      btn_mute = UI.ControlCenter.createControl({
        type: "button", name: "Mute", value: true, mode: "toggle"
      }, masterSection);

      // synth section
      var sliderSection = UI.ControlCenter.createSection("Synth", "i-container");
      var
      list_synthPreset = UI.ControlCenter.createControl({
        type: "indexed-list", name: "Waveform", value: "Sawtooth",
        data: ["Sine", "Sawtooth", "Sqaure", "Triangle", "Custom"]
      }, sliderSection),
      slider_freq = UI.ControlCenter.createControl({
        type: "slider", name: "Frequency", value: 440.0, min: 60.0, max: 1760.0,
        precision: 1, scale: "log", unit: "Hz"
      }, sliderSection),
      slider_detune = UI.ControlCenter.createControl({
        type: "slider", name: "Detune", value: 0, min: -1200, max: 1200.0,
        precision: 0, scale: "linear", unit: "cents"
      }, sliderSection),
      slider_gain = UI.ControlCenter.createControl({
        type: "slider", name: "Gain", value: -6, min: -80.0, max: 12.0,
        precision: 2, scale: "linear", unit: "dB"
      }, sliderSection);

      var miscSection = UI.ControlCenter.createSection("Misc", "i-container");
      var
      btn_preview = UI.ControlCenter.createControl({
        type: "button", name: "Preview", value: false, mode: "momentary",
        exclude: true
      }, miscSection);


      // actions
      btn_savePreset.addAction(function () {
        var name = window.prompt("Save preset as...");
        UI.ControlCenter.savePreset(name);
        // and update preset_list
        list_presets.addListItem(name);
      });

      list_presets.addAction(function (value) {
        UI.ControlCenter.loadPreset(value);
      });

      /**
       * MIDI
       */
      var target = Ktrl.createTarget("test");
      target.onData(function (midimessage) {
        var data = Ktrl.parse(midimessage);
        switch (data.type) {
          case "controlchange":
            UI.ControlCenter.handleMIDILearn(data);
            break;
        }
      });

      Ktrl.ready(function () {
        Ktrl.routeAllToTarget(target);
        target.activate();
      });
    </script>
  </body>
</html>