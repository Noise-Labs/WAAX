<!DOCTYPE html>

<html lang="en">
<head>
	<meta charset="utf-8">
	<title>WAAX API Reference Source: waax.header.js</title>

	<!--[if lt IE 9]>
	<script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
	<![endif]-->
	<link type="text/css" rel="stylesheet" href="styles/sunlight.default.css">

	
	<link type="text/css" rel="stylesheet" href="styles/site.journal.css">
	
</head>

<body>
<div class="container-fluid">
	<div class="navbar navbar-fixed-top ">
		<div class="navbar-inner">
			<a class="brand" href="index.html">WAAX API Reference</a>
			<ul class="nav">
				
				<li class="dropdown">
					<a href="namespaces.list.html" class="dropdown-toggle" data-toggle="dropdown">Namespaces<b
						class="caret"></b></a>

					<ul class="dropdown-menu ">
						
						<li>
							<a href="AudioNode.html">AudioNode</a>
						</li>
						
						<li>
							<a href="AudioParam.html">AudioParam</a>
						</li>
						
						<li>
							<a href="WX.html">WX</a>
						</li>
						
						<li>
							<a href="WX.Log.html">Log</a>
						</li>
						
						<li>
							<a href="WX.PlugIn.html">PlugIn</a>
						</li>
						

					</ul>
				</li>
				
			</ul>
		</div>
	</div>

	<div class="row-fluid">

		
			<div class="span12">
				
				<div id="main">
					


		<h1 class="page-title">Source: waax.header.js</h1>
    
    <section>
        <article>
            <pre class="sunlight-highlight-javascript linenums">/**
 * @fileOverview WX Namespace and basic Web Audio API wrapper.
 * @author Hongchan Choi (hoch)
 * @license MIT
 */

/**
 * @namespace WX
 */
window.WX = {};

(function (WX) {

  'use strict';

  // System info
  var _API_VERSION = '1.0.0-alpha3';

  /**
   * Returns WAAX API version number. (semantic version)
   * @returns {Number} WAAX API version number
   * @see {@link http://semver.org/}
   */
  WX.getVersion = function () {
    return _API_VERSION;
  };


  // Feature detection and monkey patching: AudioContext
  var _audioContextFlagWebKit = window.hasOwnProperty('webkitAudioContext'),
      _audioContextFlagNonPrefixed = window.hasOwnProperty('AudioContext');
  if (!_audioContextFlagWebKit &amp;&amp; !_audioContextFlagNonPrefixed) {
    // FATAL: non-supported browser. stop everything and escape.
    // console.log('FATAL: Web Audio API is not supported.');
    throw new Error('FATAL: Web Audio API is not supported.');
  } else {
    if (_audioContextFlagWebKit &amp;&amp; !_audioContextFlagNonPrefixed) {
      window.AudioContext = window.webkitAudioContext;
    }
  }

  // WAAX internal audio context
  WX._ctx = new AudioContext();

  // ECMA Script 5 getter for current time and srate
  Object.defineProperties(WX, {

    /**
     * Returns current audio context time. (ECMA Script 5 Getter)
     * @memberOf WX
     * @return {Number} Current audio context time in seconds.
     */
    now: {
      get: function () {
        return WX._ctx.currentTime;
      }
    },

    /**
     * Returns current audio device sample rate. (ECMA Script 5 Getter)
     * @memberOf WX
     * @return {Number} Current sample rate.
     */
    srate: {
      get: function () {
        return WX._ctx.sampleRate;
      },
    }
  });

  /**
   * Injects into window.AudioNode
   * @namespace AudioNode
   */

  /**
   * Connects a WA node to the other WA nodes. Note that this method is
   *   injected to AudioNode.prototype. Supports multiple outgoing
   *   connections. (fanning out) Returns the first WA node to enable method
   *   chaining.
   * @memberOf AudioNode
   * @param {...AudioNode} target WA nodes.
   * @return {AudioNode} The first target WA node.
   */
  window.AudioNode.prototype.to = function () {
    for (var i = 0; i &lt; arguments.length; i++) {
      this.connect(arguments[i]);
    }
    return arguments[0];
  };

  /**
   * Disconnects outgoing connection of a WA node. Note that this method is
   *   injected to AudioNode.prototype.
   * @memberOf AudioNode
   */
  window.AudioNode.prototype.cut = function () {
    this.disconnect();
  };

  /**
   * Injects into window.AudioParam
   * @namespace AudioParam
   */

  /**
   * Equivalent of AudioParam.cancelScheduledValues. Cancels scheduled value
   *   after a given starting time.
   * @memberOf AudioParam
   * @method
   * @see  http://www.w3.org/TR/webaudio/#dfn-cancelScheduledValues
   */
  window.AudioParam.prototype.cancel =
  window.AudioParam.prototype.cancelScheduledValues;

  /**
   * Manipulates AudioParam dynamically.
   * @memberOf AudioParam
   * @param {Number} value Target parameter value
   * @param {Number|Array} time Automation start time. With rampType 3, this
   *   argument must be an array specifying [start time, time constant].
   * @param {Number} rampType Automation ramp type. 0 = step, 1 = linear,
   *   2 = exponential, 3 = target value &lt;code>start, time constant]&lt;/code>
   * @see  http://www.w3.org/TR/webaudio/#methodsandparams-AudioParam-section
   */
  window.AudioParam.prototype.set = function (value, time, rampType) {
    var now = WX._ctx.currentTime;
    switch (rampType) {
      case 0:
      case undefined:
        time = (time &lt; now) ? now : time;
        this.setValueAtTime(value, time);
        // TO FIX: when node is not connected, automation will not work
        // this hack handles the error
        if (time &lt;= now &amp;&amp; value !== this.value) {
          this.value = value;
        }
        break;
      case 1:
        time = (time &lt; now) ? now : time;
        this.linearRampToValueAtTime(value, time);
        break;
      case 2:
        time = (time &lt; now) ? now : time;
        value = value &lt;= 0.0 ? 0.00001 : value;
        this.exponentialRampToValueAtTime(value, time);
        break;
      case 3:
        time[0] = (time[0] &lt; now) ? now : time[0];
        value = value &lt;= 0.0 ? 0.00001 : value;
        this.setTargetAtTime(value, time[0], time[1]);
        break;
    }
  };

  /**
   * Creates an instance of WA Gain node.
   * @return {AudioNode} WA Gain node.
   * @see  http://www.w3.org/TR/webaudio/#GainNode
   */
  WX.Gain = function() {
    return WX._ctx.createGain();
  };

  /**
   * Creates an instance of WA Oscillator node.
   * @return {AudioNode} WA Oscillator node.
   * @see  http://www.w3.org/TR/webaudio/#OscillatorNode
   */
  WX.OSC = function() {
    return WX._ctx.createOscillator();
  };

  /**
   * Creates an instance of WA Delay node.
   * @return {AudioNode} WA Delay node.
   * @see  http://www.w3.org/TR/webaudio/#DelayNode
   */
  WX.Delay = function() {
    return WX._ctx.createDelay();
  };

  /**
   * Creates an instance of WA BiquadFilter node.
   * @return {AudioNode} WA BiquadFilter node.
   * @see  http://www.w3.org/TR/webaudio/#BiquadFilterNode
   */
  WX.Filter = function() {
    return WX._ctx.createBiquadFilter();
  };

  /**
   * Creates an instance of WA DynamicCompressor node.
   * @return {AudioNode} WA DynamicsCompressor node.
   * @see  http://www.w3.org/TR/webaudio/#DynamicsCompressorNode
   */
  WX.Comp = function() {
    return WX._ctx.createDynamicsCompressor();
  };

  /**
   * Creates an instance of WA Convolver node.
   * @return {AudioNode} WA Convolver node.
   * @see  http://www.w3.org/TR/webaudio/#ConvolverNode
   */
  WX.Convolver = function() {
    return WX._ctx.createConvolver();
  };

  /**
   * Creates an instance of WA WaveShaper node.
   * @return {AudioNode} WA WaveShaper node.
   * @see  http://www.w3.org/TR/webaudio/#WaveShaperNode
   */
  WX.WaveShaper = function() {
    return WX._ctx.createWaveShaper();
  };

  /**
   * Creates an instance of WA BufferSource node.
   * @return {AudioNode} WA BufferSource node.
   * @see  http://www.w3.org/TR/webaudio/#BufferSourceNode
   */
  WX.Source = function() {
    return WX._ctx.createBufferSource();
  };

  /**
   * Creates an instance of WA Analyzer node.
   * @return {AudioNode} WA Analyzer node.
   * @see  http://www.w3.org/TR/webaudio/#AnalyzerNode
   */
  WX.Analyzer = function() {
    return WX._ctx.createAnalyser();
  };

  /**
   * Creates an instance of WA Panner node.
   * @return {AudioNode} WA Panner node.
   * @see  http://www.w3.org/TR/webaudio/#PannerNode
   */
  WX.Panner = function() {
    return WX._ctx.createPanner();
  };

  /**
   * Creates an instance of WA PerodicWave object.
   * @return {AudioNode} WA PeriodicWave object.
   * @see  http://www.w3.org/TR/webaudio/#PeriodicWave
   */
  WX.PeriodicWave = function () {
    return WX._ctx.createPeriodicWave.apply(WX._ctx, arguments);
  };

  /**
   * Creates an instance of WA Splitter node.
   * @return {AudioNode} WA Splitter node.
   * @see  http://www.w3.org/TR/webaudio/#SplitterNode
   */
  WX.Splitter = function () {
    return WX._ctx.createChannelSplitter.apply(WX._ctx, arguments);
  };

  /**
   * Creates an instance of WA Merger node.
   * @return {AudioNode} WA Merger node.
   * @see  http://www.w3.org/TR/webaudio/#MergerNode
   */
  WX.Merger = function () {
    return WX._ctx.createChannelMerger.apply(WX._ctx, arguments);
  };

  /**
   * Creates an instance of WA Buffer object.
   * @return {AudioNode} WA Buffer object.
   * @see  http://www.w3.org/TR/webaudio/#Buffer
   */
  WX.Buffer = function () {
    return WX._ctx.createBuffer.apply(WX._ctx, arguments);
  };

  /**
   * Loads WAAX clip by XHR loading
   * @param  {Object} clip WAAX Clip
   * @param  {callback_loadClip_oncomplete} oncomplete Function called when
   *   completed.
   * @param  {callback_loadClip_onprogress} onprogress &lt;i>Optional.&lt;/i>
   *   Callback for progress report.
   * @example
   * // Creates a WAAX clip on the fly.
   * var clip = {
   *   name: 'Cool Sample',
   *   url: 'http://mystaticdata.com/samples/coolsample.wav',
   *   buffer: null
   * };
   * // Loads the clip and assign the buffer to a sampler plug-in.
   * WX.loadClip(clip, function (clip) {
   *   mySampler.setBuffer(clip.buffer);
   * });
   */
  WX.loadClip = function (clip, oncomplete, onprogress) {
    if (!oncomplete) {
      Log.error('Specify `oncomplete` action.');
      return;
    }
    var xhr = new XMLHttpRequest();
    xhr.open('GET', clip.url, true);
    xhr.responseType = 'arraybuffer';
    xhr.onprogress = function (event) {
      if (onprogress) {
        onprogress(event, clip);
      }
    };
    xhr.onload = function (event) {
      try {
        WX._ctx.decodeAudioData(
          xhr.response,
          function (buffer) {
            clip.buffer = buffer;
            oncomplete(clip);
          }
        );
      } catch (error) {
        WX.Log.error(
          'Loading clip failed. (XHR failure)',
          error.message,
          clip.url
        );
      }
    };
    xhr.send();
  };

  /**
   * Callback for clip loading completion. Called by {@link WX.loadClip}.
   * @callback loadClip_oncomplete
   * @param {Object} clip WAAX clip
   * @see {@link WX.loadClip}
   */

  /**
   * Callback for clip loading progress report. called by {@link WX.loadClip}.
   * @callback loadClip_onprogress
   * @param {Object} event XHR progress event object
   * @param {Object} clip WAAX clip
   * @see {@link WX.loadClip}
   * @see {@link https://dvcs.w3.org/hg/progress/raw-file/tip/Overview.html}
   */


  //
  // constants
  //

  WX.WAVEFORMS = [
    { key: 'Sine', value: 'sine' },
    { key: 'Square', value: 'square' },
    { key: 'Sawtooth', value: 'sawtooth' },
    { key: 'Triangle', value: 'triangle' }
  ];

  WX.FILTER_TYPES = [
    { key:'LP' , value: 'lowpass' },
    { key:'HP' , value: 'highpass' },
    { key:'BP' , value: 'bandpass' },
    { key:'LS' , value: 'lowshelf' },
    { key:'HS' , value: 'highshelf' },
    { key:'PK' , value: 'peaking' },
    { key:'BR' , value: 'notch' },
    { key:'AP' , value: 'allpass' }
  ];

})(WX);</pre>
        </article>
    </section>





				</div>

				<div class="clearfix"></div>
				<footer>
					
					
		<span class="copyright">
		2011-2014 Copyright Hongchan Choi.
		</span>
					<br />
					
		<span class="jsdoc-message">
		Documentation generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc 3.3.0-alpha5</a>
		on Mon Dec 29 2014 16:42:25 GMT-0800 (PST) using the <a href="https://github.com/terryweiss/docstrap">DocStrap template</a>.
		</span>
				</footer>
			</div>

			
			<br clear="both">
		</div>

	</div>
	<script src="scripts/sunlight.js"></script>
	<script src="scripts/sunlight.javascript.js"></script>
	<script src="scripts/sunlight-plugin.doclinks.js"></script>
	<script src="scripts/sunlight-plugin.linenumbers.js"></script>
	<script src="scripts/sunlight-plugin.menu.js"></script>
	<script src="scripts/jquery.min.js"></script>
	<script src="scripts/jquery.scrollTo.js"></script>
	<script src="scripts/jquery.localScroll.js"></script>
	<script src="scripts/bootstrap-dropdown.js"></script>
	<script src="scripts/toc.js"></script>


	<script>  Sunlight.highlightAll({lineNumbers:true,  showMenu: true, enableDoclinks :true}); </script>

	<script>
		$( function () {
			$( "#toc" ).toc( {
				selectors   : "h1,h2,h3,h4",
				showAndHide : false,
				scrollTo    : 60
			} );
			$( "#toc>ul" ).addClass( "nav nav-pills nav-stacked" );
			$( "#main span[id^='toc']" ).addClass( "toc-shim" );

		} );
	</script>

	

</body>
</html>
