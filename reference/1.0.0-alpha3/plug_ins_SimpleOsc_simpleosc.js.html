<!doctype html>
<html>

<head>
  <meta name="generator" content="JSDoc 3.4.0-dev">
  <meta charset="utf-8">
  <title>Source: plug_ins/SimpleOsc/simpleosc.js</title>
  <link rel="stylesheet" href="http://brick.a.ssl.fastly.net/Karla:400,400i,700,700i" type="text/css">
  <link rel="stylesheet" href="http://brick.a.ssl.fastly.net/Noto+Serif:400,400i,700,700i" type="text/css">
  <link rel="stylesheet" href="http://brick.a.ssl.fastly.net/Inconsolata:500" type="text/css">
  <link href="css/baseline.css" rel="stylesheet">
</head>

<body onload="prettyPrint()">
  <nav id="jsdoc-navbar" role="navigation" class="jsdoc-navbar">
    <div id="jsdoc-navbar-container">
      <div id="jsdoc-navbar-content">
        <a href="index.html" class="jsdoc-navbar-package-name">Home</a>
      </div>
    </div>
  </nav>
  <div id="jsdoc-body-container">
    <div id="jsdoc-content">
      <div id="jsdoc-content-container">
        <div id="jsdoc-banner" role="banner">
        </div>
        <div id="jsdoc-main" role="main">
          <header class="page-header">
            <h1>Source: plug_ins/SimpleOsc/simpleosc.js</h1>
          </header>
          <article>
            <pre class="prettyprint linenums"><code>// Copyright 2011-2014 Hongchan Choi. All rights reserved.
// Use of this source code is governed by MIT license that can be found in the
// LICENSE file.

(function (WX) {

  &#x27;use strict&#x27;;

  /**
   * Implements SimpleOsc insturment.
   * @type {WAPL}
   * @name SimpleOsc
   * @class
   * @memberOf WX
   * @param {Object} preset Parameter preset.
   * @param {GenericParam} preset.oscType Oscillator type.
   * @param {GenericParam} preset.oscFreq Oscillator frequency.
   * @param {ItermizedParam} preset.lfoType LFO type.
   * @param {GenericParam} preset.lfoRate LFO rate.
   * @param {GenericParam} preset.lfoDepth LFO depth.
   */
  function SimpleOsc(preset) {

    // REQUIRED: adding necessary modules
    WX.PlugIn.defineType(this, &#x27;Generator&#x27;);

    // patching, lfo frequency modulation
    this._lfo = WX.OSC();
    this._lfoGain = WX.Gain();
    this._osc = WX.OSC();
    this._amp = WX.Gain();
    this._osc.to(this._amp).to(this._output);
    this._lfo.to(this._lfoGain).to(this._osc.detune);
    this._lfo.start(0);
    this._osc.start(0);

    this._amp.gain.value = 0.0;

    // parameter definition
    WX.defineParams(this, {

      oscType: {
        type: &#x27;Itemized&#x27;,
        name: &#x27;Waveform&#x27;,
        default: &#x27;sine&#x27;, // all code-side representation should be &#x27;value&#x27;
        model: WX.WAVEFORMS
      },

      oscFreq: {
        type: &#x27;Generic&#x27;,
        name: &#x27;Freq&#x27;,
        default: WX.mtof(60),
        min: 20.0,
        max: 5000.0,
        unit: &#x27;Hertz&#x27;
      },

      lfoType: {
        type: &#x27;Itemized&#x27;,
        name: &#x27;LFO Type&#x27;,
        default: &#x27;sine&#x27;,
        model: WX.WAVEFORMS
      },

      lfoRate: {
        type: &#x27;Generic&#x27;,
        name: &#x27;Rate&#x27;,
        default: 1.0,
        min: 0.0,
        max: 20.0,
        unit: &#x27;Hertz&#x27;
      },

      lfoDepth: {
        type: &#x27;Generic&#x27;,
        name: &#x27;Depth&#x27;,
        default: 1.0,
        min: 0.0,
        max: 500.0,
        unit: &#x27;LinearGain&#x27;
      }

    });

    WX.PlugIn.initPreset(this, preset);
  }

  SimpleOsc.prototype = {

    info: {
      name: &#x27;SimpleOsc&#x27;,
      version: &#x27;0.0.2&#x27;,
      api_version: &#x27;1.0.0-alpha&#x27;,
      author: &#x27;Hongchan Choi&#x27;,
      type: &#x27;Generator&#x27;,
      description: &#x27;1 OSC with LFO&#x27;
    },

    defaultPreset: {
      oscType: &#x27;sine&#x27;,
      oscFreq: WX.mtof(60),
      lfoType: &#x27;sine&#x27;,
      lfoRate: 1.0,
      lfoDepth: 1.0
    },

    $oscType: function (value, time, rampType) {
      this._osc.type = value;
    },

    $oscFreq: function (value, time, rampType) {
      this._osc.frequency.set(value, time, rampType);
    },

    $lfoType: function (value, time, rampType) {
      this._lfo.type = value;
    },

    $lfoRate: function (value, time, rampType) {
      this._lfo.frequency.set(value, time, rampType);
    },

    $lfoDepth: function (value, time, rampType) {
      this._lfoGain.gain.set(value, time, rampType);
    },

    /**
     * Start a note with pitch, velocity at time in seconds.
     * @param  {Number} pitch    MIDI pitch
     * @param  {Number} velocity MIDI velocity.
     * @param  {Number} time     Time in seconds.
     */
    noteOn: function (pitch, velocity, time) {
      time = (time || WX.now);
      this._amp.gain.set(velocity / 127, [time, 0.02], 3);
      this.params.oscFreq.set(WX.mtof(pitch), time + 0.02, 0);
      // this.$oscFreq(WX.mtof(pitch), time + 0.02, 0);
    },

    /**
     * Stop a note at time in seconds.
     * @param  {Number} time     Time in seconds.
     */
    noteOff: function (time) {
      time = (time || WX.now);
      this._amp.gain.set(0.0, [time, 0.2], 3);
    },

    /**
     * Route incoming event data from other WAAX input devices.
     * @param  {String} action Action type: [&#x27;noteon&#x27;, &#x27;noteoff&#x27;]
     * @param  {Object} data   Event data.
     * @param  {Object} data.pitch   MIDI Pitch
     * @param  {Object} data.velocity   MIDI Velocity.
     */
    onData: function (action, data) {
      switch (action) {
        case &#x27;noteon&#x27;:
          this.noteOn(data.pitch, data.velocity);
          break;
        case &#x27;noteoff&#x27;:
          this.noteOff();
          break;
      }
    }
  };

  WX.PlugIn.extendPrototype(SimpleOsc, &#x27;Generator&#x27;);
  WX.PlugIn.register(SimpleOsc);

})(WX);</code></pre>
          </article>
        </div>
      </div>
      <nav id="jsdoc-toc-nav" role="navigation"></nav>
    </div>
  </div>
  <footer id="jsdoc-footer" class="jsdoc-footer">
    <div id="jsdoc-footer-container">
      <p>
        Generated by <a href="https://github.com/jsdoc3/jsdoc">JSDoc</a> 3.4.0-dev on February 5, 2015.
      </p>
    </div>
  </footer>
  <script src="scripts/jquery.min.js"></script>
  <script src="scripts/jquery.cookie.js"></script>
  <script src="scripts/tree.jquery.js"></script>
  <script src="scripts/prettify.js"></script>
  <script src="scripts/jsdoc-toc.js"></script>
  <script src="scripts/linenumber.js"></script>
  <script src="scripts/scrollanchor.js"></script>
</body>

</html>