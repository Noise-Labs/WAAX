<!DOCTYPE html>
<html>
  <head>
  </head>
  <body>
    <h1>FM test</h1>
    <script src="../build/waax.min.js"></script>
    <script>
      // trigger a note with a bit of twist
      var rel = 2.0;
      function noteOn(pitch) {
        var cf = WX.pitch2freq(pitch), hr = 1, mi = 4;
        // mod
        var m = WX.Oscil({
          freq: cf * hr,
          gain: cf * hr * mi
        });
        // car
        var c = WX.Oscil({
          freq: cf,
          gain: 0.0
        });
        // build
        m.control(c.freq_);
        c.to(WX.DAC);

        m
          .gain(cf * hr * mi, WX.now)
          .gain(cf * hr * mi / 4, WX.now + rel, "x");
        c
          .gain(0.0, WX.now)
          .gain(0.4, WX.now + 0.001, "l")
          .gain(0.0, WX.now + rel, "x");

        m.stop(WX.now + rel);
        c.stop(WX.now + rel);
      }

      window.addEventListener("keypress", function(event) {
        noteOn(event.which);
      });
      
    </script>
  </body>
</html>